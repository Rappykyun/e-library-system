graph TD
    %% === Style Definitions ===
    classDef startEnd fill:#FBBF24,stroke:#D97706,stroke-width:3px,color:#92400E,font-weight:bold
    classDef process fill:#374151,stroke:#6B7280,stroke-width:2px,color:#F9FAFB,font-weight:bold
    classDef decision fill:#3B82F6,stroke:#1D4ED8,stroke-width:2px,color:#FFFFFF,font-weight:bold
    classDef data fill:#8B5CF6,stroke:#7C3AED,stroke-width:2px,color:#FFFFFF,font-weight:bold
    classDef database fill:#F59E0B,stroke:#D97706,stroke-width:2px,color:#92400E,font-weight:bold
    classDef document fill:#6B7280,stroke:#4B5563,stroke-width:2px,color:#FFFFFF,font-weight:bold
    classDef adminFeature fill:#DC2626,stroke:#991B1B,stroke-width:2px,color:#FFFFFF,font-weight:bold
    classDef librarianFeature fill:#059669,stroke:#047857,stroke-width:2px,color:#FFFFFF,font-weight:bold
    classDef facultyFeature fill:#7C2D12,stroke:#451A03,stroke-width:2px,color:#FFFFFF,font-weight:bold
    classDef studentFeature fill:#1E40AF,stroke:#1E3A8A,stroke-width:2px,color:#FFFFFF,font-weight:bold

    %% === Main Entry & Auth ===
    Start([ðŸš€ E-Library System]):::startEnd 
    Start --> DisplayLogin[ðŸ“ Display Login Page]:::process
    subgraph "ðŸ” Authentication Process"
        direction TB
        DisplayLogin --> InputCredentials[/ðŸ“Š Enter User Credentials/]:::data
        InputCredentials --> Validate[ðŸ” Validate Credentials]:::process
        Validate --> IsValid{âœ… Login Valid?}:::decision
        IsValid -->|âŒ No| AuthFail[âš ï¸ Show Error Message]:::process --> DisplayLogin
        IsValid -->|âœ… Yes| CheckRole{ðŸ‘¤ Check User Role}:::decision
    end

    %% === Dashboards ===
    CheckRole -->|ðŸŽ›ï¸| AdminDash[ðŸŽ›ï¸ Admin Dashboard]:::adminFeature
    CheckRole -->|ðŸ“š| LibrarianDash[ðŸ“š Librarian Dashboard]:::librarianFeature
    CheckRole -->|ðŸ‘¨â€ðŸ«| FacultyDash[ðŸ‘¨â€ðŸ« Faculty Dashboard]:::facultyFeature
    CheckRole -->|ðŸŽ“| StudentDash[ðŸŽ“ Student Dashboard]:::studentFeature

    %% === STUDENT FLOW ===
    subgraph "ðŸŽ“ Student Features"
        direction TB
        StudentDash --> StudentChoice{Select Action}:::decision
        StudentChoice -->|ðŸ” Browse| BrowseBooks[Browse Books & Filter]:::studentFeature
        BrowseBooks --> DisplayBookList[/Display Book List/]:::data
        DisplayBookList --> SelectBook[Select Book]:::process
        SelectBook --> ShowBookDetails[ðŸ“„ Show Book Details]:::process
        ShowBookDetails --> BookAction{Choose Action}:::decision
        BookAction -->|ðŸ‘€ Read| ViewPDF[ðŸ“– Display PDF Viewer]:::document
        BookAction -->|â­ Bookmark| ToggleBookmark[â­ Toggle Bookmark]:::process
        ToggleBookmark --> UpdateBookmarksDB[(ðŸ’¾ Update Bookmarks)]:::database
        
        StudentChoice -->|â­ My Bookmarks| ViewBookmarks[View Bookmarked Books]:::studentFeature
        ViewBookmarks --> DisplayBookmarkList
        
        StudentChoice -->|ðŸ“š My Courses| ViewEnrolledCourses[View Enrolled Courses]:::studentFeature
        ViewEnrolledCourses --> SelectCourse[Select a Course]:::process
        SelectCourse --> DisplayCourseBooks[/Display Course Books/]:::data
    end

    %% === FACULTY FLOW ===
    subgraph "ðŸ‘¨â€ðŸ« Faculty Features"
        direction TB
        FacultyDash --> FacultyChoice{Select Action}:::decision
        FacultyChoice -->|ðŸ“– Course Shelf| ViewAssignedCourses[View Assigned Courses]:::facultyFeature
        ViewAssignedCourses --> SelectFacultyCourse[Select a Course]:::process
        SelectFacultyCourse --> DisplayFacultyCourseBooks
        FacultyChoice -->|ðŸ” Browse| FacultyBrowseLink[ðŸ”— Follows Student Browse Flow]:::process
    end

    %% === LIBRARIAN & CONTENT MGMT FLOW ===
    subgraph "ðŸ“š Librarian & Content Management"
        direction TB
        LibrarianDash --> LibChoice{Select Action}:::decision
        LibChoice -->|ðŸ“– Books| LibManageBooks[ðŸ“– Manage Books]:::librarianFeature
        LibManageBooks --> LibBookAction{Action}:::decision
        LibBookAction -- Add --> LibAddBook[Add Book Form]:::data --> LibCreateBook[Create Book Record]:::process --> LibStoreBook[(Save to DB)]:::database --> LibManageBooks
        LibBookAction -- Edit --> LibEditBook[Edit Book Form]:::data --> LibUpdateBook[Update Book Record]:::process --> LibUpdateBookDB[(Update DB)]:::database --> LibManageBooks
        LibBookAction -- Delete --> LibConfirmDelete{Delete?}:::decision -- Yes --> LibDeleteBook[Delete Book Record]:::process --> LibDeleteBookDB[(Delete from DB)]:::database --> LibManageBooks

        LibChoice -->|ðŸ·ï¸ Categories| LibManageCats[ðŸ·ï¸ Manage Categories]:::librarianFeature
    end

    %% === ADMIN FLOW ===
    subgraph "ðŸŽ›ï¸ Admin Features (CRUD Operations)"
        direction TB
        AdminDash --> AdminChoice{Select Management Area}:::decision
        
        AdminChoice -->|ðŸ‘¥ Users| AdminUserMgmt[ðŸ‘¥ Manage Users]:::adminFeature
        AdminUserMgmt --> UserAction{Action}:::decision
        UserAction -- Add --> AddUser[Add User Form]:::data --> CreateUser[Create Record]:::process --> StoreUser[(Save to DB)]:::database --> AdminUserMgmt
        UserAction -- Edit --> EditUser[Edit User Form]:::data --> UpdateUser[Update Record]:::process --> UpdateUserDB[(Update DB)]:::database --> AdminUserMgmt
        UserAction -- Delete --> ConfirmDeleteUser{Delete?}:::decision -- Yes --> DeleteUser[Delete Record]:::process --> DeleteUserDB[(Delete from DB)]:::database --> AdminUserMgmt
        
        AdminChoice -->|ðŸŽ“ Programs| AdminProgMgmt[ðŸŽ“ Manage Programs]:::adminFeature
        AdminProgMgmt --> ProgAction{Action}:::decision
        ProgAction -- Add --> AddProg[Add Program Form]:::data --> CreateProg[Create Record]:::process --> StoreProg[(Save to DB)]:::database --> AdminProgMgmt
        ProgAction -- Edit --> EditProg[Edit Program Form]:::data --> UpdateProg[Update Record]:::process --> UpdateProgDB[(Update DB)]:::database --> AdminProgMgmt
        ProgAction -- Delete --> ConfirmDeleteProg{Delete?}:::decision -- Yes --> DeleteProg[Delete Record]:::process --> DeleteProgDB[(Delete from DB)]:::database --> AdminProgMgmt

        AdminChoice -->|ðŸ“š Courses| AdminCourseMgmt[ðŸ“š Manage Courses]:::adminFeature
        AdminCourseMgmt --> CourseAction{Action}:::decision
        CourseAction -- Add --> AddCourse[Add Course Form]:::data --> CreateCourse[Create Record]:::process --> StoreCourse[(Save to DB)]:::database --> AdminCourseMgmt
        CourseAction -- Edit --> EditCourse[Edit Course Form]:::data --> UpdateCourse[Update Record]:::process --> UpdateCourseDB[(Update DB)]:::database --> AdminCourseMgmt
        CourseAction -- Delete --> ConfirmDeleteCourse{Delete?}:::decision -- Yes --> DeleteCourse[Delete Record]:::process --> DeleteCourseDB[(Delete from DB)]:::database --> AdminCourseMggmt

        AdminChoice -->|ðŸ“– Books| AdminBookLink[ðŸ”— Follows Librarian Book Flow]:::process
        AdminChoice -->|ðŸ·ï¸ Categories| AdminCatLink[ðŸ”— Follows Librarian Category Flow]:::process
    end

    %% === Links & Endpoints ===
    subgraph "Session Management"
      Logout[ðŸšª Logout]:::process --> End([ðŸ Session Ended]):::startEnd
      AdminDash --> Logout
      LibrarianDash --> Logout
      FacultyDash --> Logout
      StudentDash --> Logout
    end
    
    FacultyBrowseLink --> BrowseBooks
    AdminBookLink --> LibManageBooks
    AdminCatLink --> LibManageCats
    ViewPDF --> ShowBookDetails
    UpdateBookmarksDB --> ShowBookDetails